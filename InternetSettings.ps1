#Created 08 Feb 18 by TSgt Overgaauw (349 Comm Flight)

$Compatibility = ([byte[]](0x41,0x1f,0x00,0x00,0x53,0x08,0xad,0xba,0x04,0x00,0x00,0x00,0x8c,0x00,0x00,0x00,0x01,0x00,0x00,0x00, 
  0x04,0x00,0x00,0x00,0x0c,0x00,0x00,0x00,0xca,0xf1,0x71,0xaa,0xd1,0x79,0xd3,0x01,0x01,0x00,0x00,0x00,0x06,0x00,0x61,0x00,0x66,
  0x00,0x2e,0x00,0x6d,0x00,0x69,0x00,0x6c,0x00,0x0c,0x00,0x00,0x00,0x06,0x85,0xcf,0xac,0xd1,0x79,0xd3,0x01,0x01,0x00,0x00,0x00,
  0x07,0x00,0x6f,0x00,0x73,0x00,0x64,0x00,0x2e,0x00,0x6d,0x00,0x69,0x00,0x6c,0x00,0x0c,0x00,0x00,0x00,0x46,0x29,0x60,0xb0,0xd1,
  0x79,0xd3,0x01,0x01,0x00,0x00,0x00,0x07,0x00,0x63,0x00,0x73,0x00,0x64,0x00,0x2e,0x00,0x6d,0x00,0x69,0x00,0x6c,0x00,0x0c,0x00,
  0x00,0x00,0x70,0xf1,0x93,0xb2,0xd1,0x79,0xd3,0x01,0x01,0x00,0x00,0x00,0x08,0x00,0x64,0x00,0x69,0x00,0x73,0x00,0x61,0x00,0x2e,
  0x00,0x6d,0x00,0x69,0x00,0x6c,0x00))


Write-Host -ForegroundColor DarkYellow "Verifying Network Proxy"
Set-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings" -Name ProxyEnable -Value 1

Start-Sleep 2
Write-Host -ForegroundColor Yellow "Proxy is Enabled"
Start-Sleep 3

Write-Host -ForegroundColor DarkYellow "Enabling the following: Menu Bar, Favorites Bar, Command Bar, Status Bar, Show Tabs on Separate Row"
Set-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Internet Explorer\MINIE" -Name LinksBandEnabled -Value 1
Set-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Internet Explorer\MINIE" -Name AlwaysShowMenus -Value 1
Set-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Internet Explorer\MINIE" -Name CommandBarEnabled -Value 1
Set-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Internet Explorer\MINIE" -Name ShowStatusBar -Value 1
Set-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Internet Explorer\MINIE" -Name TabBandWidth -Value 677
Set-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Internet Explorer\MINIE" -Name LinksBandWidth -Value 200
Set-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Internet Explorer\MINIE" -Name ToolBarRow -Value 2
Set-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Internet Explorer\MINIE" -Name LinksBandRow -Value 2
Set-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Internet Explorer\MINIE" -Name ShowTabsBelowAddressBar -Value 1

Start-Sleep 2
Write-Host -ForegroundColor Yellow "Applied configuration settings"
Start-Sleep 3

Write-Host -ForegroundColor DarkYellow "Adding the following Sites to Compatability View: 'af.mil' 'csd.mil' 'disa.mil' & 'osd.mil'"
Set-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Internet Explorer\BrowserEmulation\ClearableListData" -Name UserFilter -Value $Compatibility

Start-Sleep 2
Write-Host -ForegroundColor Yellow "Sites have been added"
Start-Sleep 3


Write-Host -ForegroundColor Green "All Complete. Please relaunch your Internet Browser."
Start-Sleep 10